
R : Copyright 2001, The R Development Core Team
Version 1.2.3  (2001-04-26)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

[Previously saved workspace restored]

> invisible(options(echo = TRUE))
> source("../../lqd/rewtanh2.R")
> 
> 
> # tmp <-
> # cbind(ss35.lowe.100.1$w,ss35.lowe.100.1$pop,ss35.lowe.100.1$dep*ss35.lowe.100.1$pop,ss35.lowe.100.1$indep)
> # write.table(as.data.frame(tmp),
> #            sep=",",row.names=F,col.names=F,file="ss35.lowe.100.1.dat")
> 
> rest2 <- rewtanh(ss35.lowe.100.1$par,ss35.lowe.100.1$s0^2,
+   ss35.lowe.100.1$stand.res,
+   ss35.lowe.100.1$pop,
+   ss35.lowe.100.1$dep*ss35.lowe.100.1$pop,
+   ss35.lowe.100.1$indep)
Warning messages: 
1: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
2: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
3: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
4: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
5: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
6: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
7: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
8: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
9: non-integer #successes in a binomial glm! in: eval(expr, envir, enclos) 
> 
> summary(rest2$glmobj, dispersion=rest2$disp)

Call:
glm(formula = yprop ~ -1 + RHSmat, family = binomial(link = "logit"), 
    weights = w * nobsvec, subset = w > 0, start = bvec)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.8165  -0.9828  -0.1668   1.0162   2.7185  

Coefficients:
        Estimate Std. Error z value Pr(>|z|)    
RHSmat1  -1.9850     0.1743 -11.390  < 2e-16 ***
RHSmat2  -1.8624     0.2698  -6.902 5.12e-12 ***
RHSmat3  18.0551     7.8409   2.303   0.0213 *  
---
Signif. codes:  0  `***'  0.001  `**'  0.01  `*'  0.05  `.'  0.1  ` '  1 

(Dispersion parameter for binomial family taken to be 2.359921)

    Null deviance: 68357.25  on 105  degrees of freedom
Residual deviance:   246.24  on 102  degrees of freedom
AIC: 712.92

Number of Fisher Scoring iterations: 1

> print("sandwich SEs")
[1] "sandwich SEs"
> print(sqrt(diag(rest2$rcov)))
[1]  0.3442196  0.5147234 14.4550012
> 
> print(rest2)
$glmobj

Call:  glm(formula = yprop ~ -1 + RHSmat, family = binomial(link = "logit"),      weights = w * nobsvec, subset = w > 0, start = bvec) 

Coefficients:
RHSmat1  RHSmat2  RHSmat3  
 -1.985   -1.862   18.055  

Degrees of Freedom: 105 Total (i.e. Null);  102 Residual
Null Deviance:	    68360 
Residual Deviance: 246.2 	AIC: 712.9 

$dispersion
[1] 2.359921

$w
  [1] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
  [8] 1.0000000 1.0000000 1.0000000 0.9991333 1.0000000 1.0000000 1.0000000
 [15] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.9701178 1.0000000
 [22] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [29] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [36] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [43] 1.0000000 1.0000000 0.6708233 1.0000000 1.0000000 1.0000000 1.0000000
 [50] 0.4772292 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [57] 0.1298286 1.0000000 1.0000000 0.9119786 1.0000000 1.0000000 1.0000000
 [64] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [71] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.8735371 0.9120048
 [78] 1.0000000 1.0000000 0.8187961 1.0000000 1.0000000 1.0000000 1.0000000
 [85] 1.0000000 0.9417964 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [92] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
 [99] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000

$psi
  [1] 0.74345452 0.15704078 1.46788973 0.03443652 1.13771362 0.19074673
  [7] 1.10272031 0.10589746 0.62591164 1.17276572 1.80300014 0.40733952
 [13] 0.45386253 0.72826839 1.08844638 0.22243197 1.33465167 1.32589596
 [19] 0.80089062 1.79815854 0.11243506 0.51368388 0.57338935 1.69027984
 [25] 0.48808510 1.38304111 0.36156338 0.34120955 1.09287111 1.63353079
 [31] 0.53037736 1.24096082 0.34983277 0.67166326 0.17681961 1.25790632
 [37] 0.26463407 0.27891911 0.20846079 1.56972262 0.13951451 0.89591153
 [43] 0.48519646 0.08542953 1.67092484 0.06450286 0.75789561 0.33298363
 [49] 0.68475436 1.41865481 0.36863601 0.60993641 1.18112818 0.52315769
 [55] 0.48215138 0.31738603 0.48401128 1.38637971 1.20734633 1.78612452
 [61] 1.42801302 0.29356022 0.91114910 0.89083648 0.18497200 1.30469528
 [67] 0.76771967 0.53200677 1.30030720 0.38944687 0.21419644 0.82260724
 [73] 0.69761177 1.76630245 1.78189598 1.77599157 1.78613077 0.30403983
 [79] 0.35191486 1.75757329 1.04322860 0.99838646 0.91920907 0.12151053
 [85] 0.90484729 1.79272883 0.97659060 0.11525761 0.19115018 0.38807529
 [91] 0.46800366 0.84645881 1.25780909 0.31842737 0.20667084 1.17819577
 [97] 0.64978883 0.16271430 0.45154264 0.35493161 0.43737302 1.05836091
[103] 0.17007590 0.09325721 0.32464604

$res
  [1]  1.14209738 -0.24124658  2.25497724 -0.05290151 -1.74775956  0.29302579
  [7] -1.69400273 -0.16268004 -0.96152761 -1.80160672 -2.77217774 -0.62575638
 [13] -0.69722518  1.11876839 -1.67207507 -0.34170075 -2.05029647 -2.03684592
 [19]  1.23033091 -2.84742449  0.17272313  0.78912294  0.88084269  2.59661369
 [25] -0.74979801 -2.12463250  0.55543490 -0.52416729  1.67887235  2.50943560
 [31] -0.81476753 -1.90636827 -0.53741430  1.03181141 -0.27163090  1.93240000
 [37]  0.40653177 -0.42847650  0.32023818 -2.41141327 -0.21432268 -1.37630237
 [43] -0.74536047  0.13123713 -3.82646297  0.09908952  1.16428183 -0.51153059
 [49]  1.05192200 -4.56665760  0.56629990 -0.93698640  1.81445316 -0.80367663
 [55] -0.74068260 -0.48756951  5.72708924  2.12976127  1.85472958  3.00867888
 [61]  2.19371850  0.45096822  1.39971038  1.36850606 -0.28415463 -2.00427737
 [67] -1.17937359  0.81727063  1.99753639 -0.59826962 -0.32904931  1.26369206
 [73] -1.07167359  2.71339989  2.73735471  3.12326096  3.00860298 -0.46706702
 [79]  0.54061282 -3.29751210 -1.60261135 -1.53372470  1.41209212 -0.18666489
 [85]  1.39002950 -2.92419476  1.50024183  0.17705914 -0.29364557 -0.59616259
 [91] -0.71894883  1.30033293 -1.93225064 -0.48916922 -0.31748845 -1.80994838
 [97]  0.99820784  0.24996226  0.69366136  0.54524716  0.67189394  1.62585766
[103]  0.26127118 -0.14326205 -0.49872236

$sres
  [1]  0.74345452 -0.15704078  1.46788973 -0.03443652 -1.13771362  0.19074673
  [7] -1.10272031 -0.10589746 -0.62591164 -1.17276572 -1.80456421 -0.40733952
 [13] -0.45386253  0.72826839 -1.08844638 -0.22243197 -1.33465167 -1.32589596
 [19]  0.80089062 -1.85354650  0.11243506  0.51368388  0.57338935  1.69027984
 [25] -0.48808510 -1.38304111  0.36156338 -0.34120955  1.09287111  1.63353079
 [31] -0.53037736 -1.24096082 -0.34983277  0.67166326 -0.17681961  1.25790632
 [37]  0.26463407 -0.27891911  0.20846079 -1.56972262 -0.13951451 -0.89591153
 [43] -0.48519646  0.08542953 -2.49085693  0.06450286  0.75789561 -0.33298363
 [49]  0.68475436 -2.97269066  0.36863601 -0.60993641  1.18112818 -0.52315769
 [55] -0.48215138 -0.31738603  3.72807997  1.38637971  1.20734633  1.95851592
 [61]  1.42801302  0.29356022  0.91114910  0.89083648 -0.18497200 -1.30469528
 [67] -0.76771967  0.53200677  1.30030720 -0.38944687 -0.21419644  0.82260724
 [73] -0.69761177  1.76630245  1.78189598  2.03310375  1.95846651 -0.30403983
 [79]  0.35191486 -2.14653348 -1.04322860 -0.99838646  0.91920907 -0.12151053
 [85]  0.90484729 -1.90352053  0.97659060  0.11525761 -0.19115018 -0.38807529
 [91] -0.46800366  0.84645881 -1.25780909 -0.31842737 -0.20667084 -1.17819577
 [97]  0.64978883  0.16271430  0.45154264  0.35493161  0.43737302  1.05836091
[103]  0.17007590 -0.09325721 -0.32464604

$h
  [1] 0.0006914177 0.0041373639 0.0006304513 0.0006645721 0.0004366276
  [6] 0.0025991968 0.0138409529 0.0461724017 0.0007031709 0.0008206229
 [11] 0.0004897948 0.0043065223 0.0045802741 0.0589981079 0.0036654253
 [16] 0.0036241609 0.0020641006 0.0010208586 0.0010849743 0.0013259326
 [21] 0.0005930821 0.0039081643 0.0007404151 0.0367413796 0.0011899756
 [26] 0.0014739038 0.0006491443 0.6549652295 0.0004608051 0.0005166994
 [31] 0.0047037647 0.0059422143 0.0007247950 0.0003454468 0.0005904789
 [36] 0.0004922059 0.0038526159 0.0074458657 0.0092424908 0.0009113321
 [41] 0.0107225041 0.0114713992 0.0041023110 0.0021098552 0.0014239824
 [46] 0.0012699736 0.0366532815 0.0124169824 0.0017465101 0.0010667515
 [51] 0.0129842620 0.0034073585 0.0017825231 0.0003813794 0.1014261363
 [56] 0.0007206307 0.0020746345 0.0242653196 0.0007534425 0.0033720828
 [61] 0.0024839449 0.0010746827 0.0013891425 0.0044904591 0.0100790246
 [66] 0.8595702804 0.0031340442 0.0139396932 0.0013623115 0.0009812582
 [71] 0.2939137518 0.0004276815 0.0007062254 0.0003878221 0.0005935209
 [76] 0.0008833919 0.0026987287 0.0013197432 0.0034215379 0.0007138891
 [81] 0.0044278312 0.0007801228 0.0053894382 0.0087996951 0.0296936525
 [86] 0.0006886817 0.0008377529 0.0025479499 0.0125832928 0.0090148574
 [91] 0.0973050183 0.0414513473 0.0018321670 0.0007769628 0.1064780064
 [96] 0.0006992639 0.0007481359 0.0005396227 0.0005676703 0.0003980574
[101] 0.0005928773 0.3507200275 0.0004318365 0.0006857326 0.0006278001

$A
           [,1]       [,2]        [,3]
[1,] 3180.05857 1878.58552 11.39355014
[2,] 1878.58552 1158.12122  6.64585970
[3,]   11.39355    6.64586  0.09501281

$B
             [,1]        [,2]        [,3]
[1,] -1188.263552 -722.873525 -4.57762457
[2,]  -722.873525 -453.894840 -2.70254781
[3,]    -4.577625   -2.702548 -0.03437856

$rcovmat
           [,1]       [,2]       [,3]
[1,]  0.1184872 -0.1731851  -2.180294
[2,] -0.1731851  0.2649402   2.160220
[3,] -2.1802935  2.1602200 208.947060

$iters
[1] 9

> 
> rest2$sres/sqrt(1-rest2$h)
  [1]  0.74371167 -0.15736666  1.46835267 -0.03444797 -1.13796208  0.19099511
  [7] -1.11043181 -0.10843028 -0.62613182 -1.17324721 -1.80500631 -0.40821948
 [13] -0.45490553  0.75075150 -1.09044669 -0.22283613 -1.33603123 -1.32657325
 [19]  0.80132544 -1.85477656  0.11246842  0.51469061  0.57360174  1.72221418
 [25] -0.48837576 -1.38406147  0.36168079 -0.58088445  1.09312299  1.63395297
 [31] -0.53162917 -1.24466436 -0.34995962  0.67177931 -0.17687184  1.25821601
 [37]  0.26514531 -0.27996335  0.20943086 -1.57043837 -0.14026856 -0.90109485
 [43] -0.48619475  0.08551979 -2.49263230  0.06454386  0.77217916 -0.33507041
 [49]  0.68535311 -2.97427749  0.37105280 -0.61097821  1.18218228 -0.52325748
 [55] -0.50863533 -0.31750045  3.73195320  1.40351263  1.20780142  1.96182644
 [61]  1.42978988  0.29371809  0.91178262  0.89284338 -0.18591128 -3.48160564
 [67] -0.76892554  0.53575400  1.30119382 -0.38963809 -0.25490794  0.82278320
 [73] -0.69785824  1.76664506  1.78242501  2.03400236  1.96111456 -0.30424065
 [79]  0.35251846 -2.14730009 -1.04554592 -0.99877612  0.92169613 -0.12204871
 [85]  0.91858818 -1.90417632  0.97699993  0.11540473 -0.19236430 -0.38983643
 [91] -0.49258222  0.86456719 -1.25896293 -0.31855115 -0.21863847 -1.17860792
 [97]  0.65003203  0.16275822  0.45167086  0.35500228  0.43750273  1.31346283
[103]  0.17011264 -0.09328920 -0.32474800
> 
> cbind(ss35.lowe.100.1$w, rest2$w)
       [,1]      [,2]
  [1,]    1 1.0000000
  [2,]    1 1.0000000
  [3,]    1 1.0000000
  [4,]    1 1.0000000
  [5,]    1 1.0000000
  [6,]    1 1.0000000
  [7,]    1 1.0000000
  [8,]    1 1.0000000
  [9,]    1 1.0000000
 [10,]    1 1.0000000
 [11,]    1 0.9991333
 [12,]    1 1.0000000
 [13,]    1 1.0000000
 [14,]    1 1.0000000
 [15,]    1 1.0000000
 [16,]    1 1.0000000
 [17,]    1 1.0000000
 [18,]    1 1.0000000
 [19,]    1 1.0000000
 [20,]    1 0.9701178
 [21,]    1 1.0000000
 [22,]    1 1.0000000
 [23,]    1 1.0000000
 [24,]    1 1.0000000
 [25,]    1 1.0000000
 [26,]    1 1.0000000
 [27,]    1 1.0000000
 [28,]    1 1.0000000
 [29,]    1 1.0000000
 [30,]    1 1.0000000
 [31,]    1 1.0000000
 [32,]    1 1.0000000
 [33,]    1 1.0000000
 [34,]    1 1.0000000
 [35,]    1 1.0000000
 [36,]    1 1.0000000
 [37,]    1 1.0000000
 [38,]    1 1.0000000
 [39,]    1 1.0000000
 [40,]    1 1.0000000
 [41,]    1 1.0000000
 [42,]    1 1.0000000
 [43,]    1 1.0000000
 [44,]    1 1.0000000
 [45,]    1 0.6708233
 [46,]    1 1.0000000
 [47,]    1 1.0000000
 [48,]    1 1.0000000
 [49,]    1 1.0000000
 [50,]    0 0.4772292
 [51,]    1 1.0000000
 [52,]    1 1.0000000
 [53,]    1 1.0000000
 [54,]    1 1.0000000
 [55,]    1 1.0000000
 [56,]    1 1.0000000
 [57,]    0 0.1298286
 [58,]    1 1.0000000
 [59,]    1 1.0000000
 [60,]    1 0.9119786
 [61,]    1 1.0000000
 [62,]    1 1.0000000
 [63,]    1 1.0000000
 [64,]    1 1.0000000
 [65,]    1 1.0000000
 [66,]    1 1.0000000
 [67,]    1 1.0000000
 [68,]    1 1.0000000
 [69,]    1 1.0000000
 [70,]    1 1.0000000
 [71,]    1 1.0000000
 [72,]    1 1.0000000
 [73,]    1 1.0000000
 [74,]    1 1.0000000
 [75,]    1 1.0000000
 [76,]    1 0.8735371
 [77,]    1 0.9120048
 [78,]    1 1.0000000
 [79,]    1 1.0000000
 [80,]    1 0.8187961
 [81,]    1 1.0000000
 [82,]    1 1.0000000
 [83,]    1 1.0000000
 [84,]    1 1.0000000
 [85,]    1 1.0000000
 [86,]    1 0.9417964
 [87,]    1 1.0000000
 [88,]    1 1.0000000
 [89,]    1 1.0000000
 [90,]    1 1.0000000
 [91,]    1 1.0000000
 [92,]    1 1.0000000
 [93,]    1 1.0000000
 [94,]    1 1.0000000
 [95,]    1 1.0000000
 [96,]    1 1.0000000
 [97,]    1 1.0000000
 [98,]    1 1.0000000
 [99,]    1 1.0000000
[100,]    1 1.0000000
[101,]    1 1.0000000
[102,]    1 1.0000000
[103,]    1 1.0000000
[104,]    1 1.0000000
[105,]    1 1.0000000
> 
> round(cbind(1:105,ss35.lowe.100.1$w, rest2$w,
+             ss35.lowe.100.1$raw.res,ss35.lowe.100.1$student.res,
+             ss35.lowe.100.1$dep,ss35.lowe.100.1$pred,
+             ss35.lowe.100.1$dep-ss35.lowe.100.1$pred)[ ss35.lowe.100.1$w != rest2$w ,],4)
      [,1] [,2]   [,3]    [,4]    [,5]   [,6]   [,7]    [,8]
 [1,]   11    1 0.9991 -3.9210 -2.1935 0.0303 0.0553 -0.0250
 [2,]   20    1 0.9701 -3.8373 -2.1383 0.0179 0.0383 -0.0205
 [3,]   45    1 0.6708 -4.4071 -2.5143 0.0096 0.0616 -0.0520
 [4,]   50    0 0.4772 -5.1601 -3.0113 0.0141 0.0722 -0.0581
 [5,]   57    0 0.1298  4.3580  3.2704 0.0761 0.0416  0.0345
 [6,]   60    1 0.9120  2.2168  1.8573 0.0679 0.0433  0.0246
 [7,]   76    1 0.8735  2.1846  1.8360 0.0738 0.0549  0.0189
 [8,]   77    1 0.9120  2.6365  2.1343 0.0752 0.0461  0.0291
 [9,]   80    1 0.8188 -4.3407 -2.4705 0.0388 0.0783 -0.0395
[10,]   86    1 0.9418 -3.7291 -2.0668 0.0306 0.0629 -0.0323
> proc.time()
[1] 2.15 0.47 2.65 0.00 0.00
> 
